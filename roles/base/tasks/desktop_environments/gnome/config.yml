# Wallpaper
- name: Desktop environments | gnome | Wallpaper
  block:
    - name: Desktop environments | gnome | Adding wallpaper
      ansible.builtin.copy:
        src: files/wallpaper/wallpaper.jpg
        dest: /usr/share/backgrounds/wallpaper.jpg
        owner: root
        group: root
        mode: '0644'


    - name: Desktop environments | gnome | Setting wallpaper
      become: true
      become_user: mose
      community.general.dconf:
        key: "/org/gnome/desktop/background/picture-uri"
        value: "'file:///usr/share/backgrounds/wallpaper.jpg'"

# profile picture
- name: Desktop environments | gnome | Profile Picture
  become: true
  become_user: mose
  block:
    - name: Desktop environments | gnome | Profile Picture | Verify profile picture
      ansible.builtin.stat:
        path: /var/lib/AccountsService/icons/mose
      register: profile_picture

    - name: Desktop environments | gnome | Profile Picture | Copy profile picture
      become: true
      become_user: root
      ansible.builtin.copy:
        src: profile-picture.png
        dest: /var/lib/AccountsService/icons/mose
        force: true
        owner: root
        group: root
        mode: '0644'
      # when: not profile_picture.stat.exists

    - name: Desktop environments | gnome | Profile Picture | Set profile picture
      become: true
      become_user: root
      ansible.builtin.lineinfile:
        path: /var/lib/AccountsService/users/mose
        regexp: '^Icon='
        line: 'Icon=/var/lib/AccountsService/icons/mose'

# Status Bar
- name: Desktop environments | gnome | Interface
  tags: calendar,time
  become: true
  become_user: mose
  block:
    - name: Desktop environments | gnome | Interface | Clock settings
      community.general.dconf:
        key: /org/gnome/desktop/interface/{{ item.key }}
        value: "{{ item.value }}"
      with_items:
        - { key: "clock-show-weekday", value: "true" }
        - { key: "toolkit-accessibility", value: "false" }
        - { key: "enable-hot-corners", value: "false" }

    - name: Desktop environments | gnome | Interface | Calendar settings
      community.general.dconf:
        key: /org/gnome/desktop/calendar/show-weekdate
        value: "true"

    - name: Desktop environments | gnome | Interface | Battery
      community.general.dconf:
        key: /org/gnome/desktop/interface/{{ item.key }}
        value: "{{ item.value }}"
      with_items:
        - { key: "show-battery-percentage", value: "true" }

    - name: Desktop environments | gnome | Interface | Tray Icons
      community.general.dconf:
        key: /org/gnome/shell/extensions/trayIconsReloaded/{{ item.key }}
        value: "{{ item.value }}"
      with_items:
        - { key: "icon-brightness", value: "0" }
        - { key: "icon-contrast", value: "0" }
        - { key: "icon-margin-horizontal", value: "4" }
        - { key: "icon-padding-horizontal", value: "0" }
        - { key: "icon-saturation", value: "0" }
        - { key: "icon-size", value: "22" }
        - { key: "icons-limit", value: "6" }
        - { key: "invoke-to-workspace", value: "false" }
        - { key: "position-weight", value: "1" }
        - { key: "tray-margin-left", value: "0" }
        - { key: "tray-position", value: "'right'" }

- name: Desktop environments | gnome | System
  community.general.dconf:
    key: "{{ item.key }}"
    value: "{{ item.value }}"
  with_items:
    - { key: "/system/locale/region", value: "'de_CH.UTF-8'" }

- name: Desktop environments | gnome | Touchpad
  become: true
  become_user: mose
  community.general.dconf:
    key: /org/gnome/desktop/peripherals/touchpad/{{ item.key }}
    value: "{{ item.value }}"
  with_items:
    - { key: "tap-to-click", value: "true" }
    - { key: "two-finger-scrolling-enabled", value: "true" }
    - { key: "disable-while-typing", value: "true" }

- name: Desktop environments | gnome | Nautilus
  become: true
  become_user: mose
  block:
    - name: Preferences
      community.general.dconf:
        key: /org/gnome/nautilus/preferences/{{ item.key }}
        value: "{{ item.value }}"
      with_items:
        - { key: "default-folder-viewer", value: "'icon-view'" }
        - { key: "migrated-gtk-settings", value: "true" }
        - { key: "search-filter-time-type", value: "'last_modified'" }
        - { key: "show-create-link", value: "true" }
        - { key: "show-delete-permanently", value: "true" }

    - name: File-chooser
      community.general.dconf:
        key: /org/gtk/gtk4/settings/file-chooser/{{ item.key }}
        value: "{{ item.value }}"
      with_items:
        - { key: "show-hidden", value: "true" }
        - { key: "sort-directories-first", value: "true" }

- name: Desktop environments | gnome | Default Applications
  become: true
  become_user: mose
  community.general.dconf:
    key: /org/gnome/desktop/applications/terminal/{{ item.key }}
    value: "{{ item.value }}"
  with_items:
    - { key: "exec", value: "'alacritty'" }

- name: Desktop environments | gnome | Keybindings
  tags: keybindings
  become: true
  become_user: mose
  community.general.dconf:
    key: "{{ item.key }}"
    value: "{{ item.value }}"
  with_items:
    - { key: "/org/gnome/settings-daemon/plugins/media-keys/custom-keybindings/custom0/name", value: "'Terminal'" }
    - { key: "/org/gnome/settings-daemon/plugins/media-keys/custom-keybindings/custom0/binding", value: "'<Super>Return'" }
    - { key: "/org/gnome/settings-daemon/plugins/media-keys/custom-keybindings/custom0/command", value: "'alacritty'" }
    - { key: "/org/gnome/settings-daemon/plugins/media-keys/custom-keybindings/custom1/name", value: "'Spotify'" }
    - { key: "/org/gnome/settings-daemon/plugins/media-keys/custom-keybindings/custom1/binding", value: "'<Shift><Super>S'" }
    - { key: "/org/gnome/settings-daemon/plugins/media-keys/custom-keybindings/custom1/command", value: "'flatpak run com.spotify.Client'" }
    - { key: "/org/gnome/settings-daemon/plugins/media-keys/home", value: "@as []" }
    - { key: "/org/gnome/settings-daemon/plugins/media-keys/www", value: "['<Shift><Super>f']" }
    - { key: "/org/gnome/desktop/wm/keybindings/close", value: "['<Shift><Super>q']" }
    - { key: "/org/gnome/desktop/wm/keybindings/maximize", value: "@as []" }
    - { key: "/org/gnome/desktop/wm/keybindings/toggle-maximized", value: "['<Super>f']" }
    - { key: "/org/gnome/desktop/wm/keybindings/move-to-monitor-down", value: "['<Shift><Super>j']" }
    - { key: "/org/gnome/desktop/wm/keybindings/move-to-monitor-left", value: "['<Shift><Super>h']" }
    - { key: "/org/gnome/desktop/wm/keybindings/move-to-monitor-right", value: "['<Shift><Super>l']" }
    - { key: "/org/gnome/desktop/wm/keybindings/move-to-monitor-up", value: "['<Shift><Super>k']" }

- name: Desktop environments | gnome | Workspaces
  tags: keybindings
  become: true
  become_user: mose
  community.general.dconf:
    key: "{{ item.key }}"
    value: "{{ item.value }}"
  with_items:
    - { key: "/org/gnome/shell/keybindings/switch-to-application-1", value: "@as []" }
    - { key: "/org/gnome/shell/keybindings/switch-to-application-2", value: "@as []" }
    - { key: "/org/gnome/shell/keybindings/switch-to-application-3", value: "@as []" }
    - { key: "/org/gnome/shell/keybindings/switch-to-application-4", value: "@as []" }
    - { key: "/org/gnome/shell/keybindings/switch-to-application-5", value: "@as []" }
    - { key: "/org/gnome/shell/keybindings/switch-to-application-6", value: "@as []" }
    - { key: "/org/gnome/shell/keybindings/switch-to-application-7", value: "@as []" }
    - { key: "/org/gnome/shell/keybindings/switch-to-application-8", value: "@as []" }
    - { key: "/org/gnome/shell/keybindings/switch-to-application-9", value: "@as []" }
    - { key: "/org/gnome/desktop/wm/preferences/num-workspaces", value: "10" }
    - { key: "/org/gnome/desktop/wm/preferences/focus-mode", value: "'sloppy'" }
    - { key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-1", value: "['<Super>1']" }
    - { key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-2", value: "['<Super>2']" }
    - { key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-3", value: "['<Super>3']" }
    - { key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-4", value: "['<Super>4']" }
    - { key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-5", value: "['<Super>5']" }
    - { key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-6", value: "['<Super>6']" }
    - { key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-7", value: "['<Super>7']" }
    - { key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-8", value: "['<Super>8']" }
    - { key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-9", value: "['<Super>9']" }
    - { key: "/org/gnome/desktop/wm/keybindings/switch-to-workspace-10", value: "['<Super>0']" }
    - { key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-1", value: "['<Super><Shift>1']" }
    - { key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-2", value: "['<Super><Shift>2']" }
    - { key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-3", value: "['<Super><Shift>3']" }
    - { key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-4", value: "['<Super><Shift>4']" }
    - { key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-5", value: "['<Super><Shift>5']" }
    - { key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-6", value: "['<Super><Shift>6']" }
    - { key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-7", value: "['<Super><Shift>7']" }
    - { key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-8", value: "['<Super><Shift>8']" }
    - { key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-9", value: "['<Super><Shift>9']" }
    - { key: "/org/gnome/desktop/wm/keybindings/move-to-workspace-10", value: "['<Super><Shift>0']" }
    - { key: "/org/gnome/mutter/dynamic-workspaces", value: "false" }
    - { key: "/org/gnome/mutter/edge-tiling", value: "false" }
    - { key: "/org/gnome/mutter/workspaces-only-on-primary", value: "true" }
    - { key: "/org/gnome/shell/app-switcher/current-workspace-only", value: "true" }
    - { key: "/org/gnome/shell/extensions/auto-move-windows/application-list", value: "['com.slack.Slack.desktop:9', 'com.spotify.Client.desktop:10', 'rambox.desktop:9', 'firefox.desktop:1', 'code.desktop:2']" }

- name: Desktop environments | gnome | Pop shell
  tags: keybindings
  become: true
  become_user: mose
  community.general.dconf:
    key: "{{ item.key }}"
    value: "{{ item.value }}"
  with_items:
    - { key: "/org/gnome/shell/enabled-extensions", value: "['pop-shell@system76.com', 'launch-new-instance@gnome-shell-extensions.gcampax.github.com', 'auto-move-windows@gnome-shell-extensions.gcampax.github.com', 'trayIconsReloaded@selfmade.pl']" }
    - { key: "/org/gnome/shell/extensions/pop-shell/activate-launcher", value: "['<Super>d']" }
    - { key: "/org/gnome/shell/extensions/pop-shell/active-hint", value: "false" }
    - { key: "/org/gnome/shell/extensions/pop-shell/active-hint-border-radius", value: "uint32 5" }
    - { key: "/org/gnome/shell/extensions/pop-shell/fullscreen-launcher", value: "true" }
    - { key: "/org/gnome/shell/extensions/pop-shell/gap-inner", value: "uint32 1" }
    - { key: "/org/gnome/shell/extensions/pop-shell/gap-outer", value: "uint32 1" }
    - { key: "/org/gnome/shell/extensions/pop-shell/log-level", value: "uint32 2" }
    - { key: "/org/gnome/shell/extensions/pop-shell/mouse-cursor-focus-location", value: "uint32 0" }
    - { key: "/org/gnome/shell/extensions/pop-shell/pop-monitor-down", value: "@as []" }
    - { key: "/org/gnome/shell/extensions/pop-shell/pop-monitor-left", value: "@as []" }
    - { key: "/org/gnome/shell/extensions/pop-shell/pop-monitor-right", value: "@as []" }
    - { key: "/org/gnome/shell/extensions/pop-shell/pop-monitor-up", value: "@as []" }
    - { key: "/org/gnome/shell/extensions/pop-shell/pop-workspace-down", value: "@as []" }
    - { key: "/org/gnome/shell/extensions/pop-shell/pop-workspace-up", value: "@as []" }
    - { key: "/org/gnome/shell/extensions/pop-shell/smart-gaps", value: "false" }
    - { key: "/org/gnome/shell/extensions/pop-shell/snap-to-grid", value: "true" }
    - { key: "/org/gnome/shell/extensions/pop-shell/stacking-with-mouse", value: "true" }
    - { key: "/org/gnome/shell/extensions/pop-shell/tile-by-default", value: "true" }
    - { key: "/org/gnome/shell/extensions/pop-shell/tile-enter", value: "['<Super>r']" }
    - { key: "/org/gnome/shell/extensions/pop-shell/toggle-tiling", value: "@as []" }


- name: Desktop environments | gnome | Config | Displays
  become: true
  become_user: mose
  community.general.dconf:
    key: "{{ item.key }}"
    value: "{{ item.value }}"
  with_items:
    - { key: "/org/gnome/mutter/experimental-features", value: "['scale-monitor-framebuffer']" }

# vim: ft=yaml.ansible
